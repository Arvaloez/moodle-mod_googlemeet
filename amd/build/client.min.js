define(["core/notification","core/str"],function(a,b){return{init:function(c,d,e){function f(){gapi.client.init({apiKey:d,clientId:c,discoveryDocs:l,scope:e}).then(function(){gapi.auth2.getAuthInstance().signOut(),r.onclick=g},function(a){r.disabled=!0,h(JSON.stringify(a,null,2))})}function g(){var a=new FormData(u),b=document.getElementById("id_name"),c=document.getElementById("id_error_name");return 0===a.get("name").trim().length?(b.classList.add("is-invalid"),b.focus(),void(c.innerText="- "+m)):(b.classList.remove("is-invalid"),c.innerText="",void gapi.auth2.getAuthInstance().signIn({prompt:"select_account"}).then(function(){j()}))}function h(a){var b=document.getElementById("googlemeetlog");b.setAttribute("open",!0);var c=document.getElementById("googlemeetcontentlog"),d=document.createTextNode(a+"\n");c.appendChild(d)}function i(){var a=["id_url","id_timeopen_enabled","id_timeopen_day","id_timeopen_month","id_timeopen_year","id_timeopen_hour","id_timeopen_minute","id_timeopen_calendar","id_timeclose_enabled","id_timeclose_day","id_timeclose_month","id_timeclose_year","id_timeclose_hour","id_timeclose_minute","id_timeclose_calendar","id_generateLink"];a.forEach(function(a){var b=document.getElementById(a);return"checkbox"===b.getAttribute("type")?void(b.parentElement.style.display="none"):(b.setAttribute("readonly",!0),b.style.pointerEvents="none",b.style.touchAction="none",b.setAttribute("tabindex","-1"),void b.setAttribute("aria-disabled",!0))})}function j(){var a=new FormData(u),b=new Date,c={},d={};c=a.get("timeopen[enabled]")?{dateTime:a.get("timeopen[year]")+"-"+a.get("timeopen[month]")+"-"+a.get("timeopen[day]")+"T"+a.get("timeopen[hour]")+":"+a.get("timeopen[minute]")+":00"+a.get("timezoneoffset"),timezone:a.get("timezone")}:{date:b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()},d=a.get("timeclose[enabled]")?{dateTime:a.get("timeclose[year]")+"-"+a.get("timeclose[month]")+"-"+a.get("timeclose[day]")+"T"+a.get("timeclose[hour]")+":"+a.get("timeclose[minute]")+":00"+a.get("timezoneoffset"),timezone:a.get("timezone")}:{date:b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()},h(n);var e={summary:a.get("name"),description:a.get("introeditor[text]"),start:c,end:d},f=gapi.client.calendar.events.insert({calendarId:"primary",resource:e});f.execute(function(a){h("   "+o+": "+a.creator.email),h(p);var b={conferenceData:{createRequest:{requestId:a.id}}};gapi.client.calendar.events.patch({calendarId:"primary",eventId:a.id,resource:b,sendNotifications:!1,conferenceDataVersion:1}).execute(function(a){h("   "+q+": "+a.hangoutLink),s.value=a.hangoutLink,s.focus(),s.classList.remove("is-invalid"),t.innerText="",i()})})}function k(){gapi.load("client:auth2",f)}var l=["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],m="",n="",o="",p="",q="";b.get_strings([{key:"requiredfield",component:"mod_googlemeet"},{key:"creatingcalendarevent",component:"mod_googlemeet"},{key:"eventsuccessfullycreated",component:"mod_googlemeet"},{key:"creatingconferenceroom",component:"mod_googlemeet"},{key:"conferencesuccessfullycreated",component:"mod_googlemeet"}]).done(function(a){m=a[0],n=a[1],o=a[2],p=a[3],q=a[4]}).fail(a.exception);var r=document.getElementById("id_generateLink"),s=document.getElementById("id_url"),t=document.getElementById("id_error_url"),u=document.querySelector("#region-main .mform");window.addEventListener("load",k(),!1)}}});